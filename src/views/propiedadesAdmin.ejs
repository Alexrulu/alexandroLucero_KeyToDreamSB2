<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="stylesheet" href="/styles/header.css">
  <link rel="stylesheet" href="/styles/styles.css">
  <link rel="stylesheet" href="/styles/comprar-alquilar.css">
  <script src="https://kit.fontawesome.com/a4c24707d1.js" crossorigin="anonymous"></script>
  <title>Document</title>
</head>
<body>
  <header>
    <a href="/"><img class="header-logo-top-icon" src="/images/favicon.jpg"></a>
    <h2 class="header-logo-top-name">KEY TO DREAM</h2>
    <div class="left-header">
      <i class="fa-solid fa-bars"></i>
      <h3><a href="/">INICIO</a></h3>
      <h3><p id="filtrar-alquileres" data-type="alquiler" style="text-decoration: none; color: inherit;">ALQUILERES</a></h3>
      <h3><p id="filtrar-ventas" data-type="venta" style="text-decoration: none; color: inherit;">VENTAS</p></h3>
      <h3><p id="mostrar-todo" data-type="todas" style="text-decoration: none; color: inherit;">MOSTRAR TODO</p></h3>
    </div>
    <div class="right-header">
      <h3>
        <i class="fa-solid fa-magnifying-glass lupa-tactil-inCategory"></i>
        <input type="search" placeholder="Ciudad" class="header-buscar"></input>
      </h3>
      <h3 class="administrador-h3">ADMINISTRADOR</h3>
    </div>
  </header>
  <main class="main-propiedades-admin">
    <% function getPropertyType(typeValue) {
      const propiedades_type = { 1: "VENTA", 2: "ALQUILER", 3: "TEMPORADA" };
      return propiedades_type[typeValue] || "DESCONOCIDO";
    }%>
    <!-- Bloque: Todas las propiedades -->
    <% propiedades.forEach(propiedad => { %>
      <a class="todas-propiedades" href="/articulo/<%= propiedad.id %>">
        <article class="article-box-admin">
          <div style="display: flex">
            <div><img class="img-imagendepropiedades-admin" src="<%= propiedad.principalImage %>"></div>
            <div class="left-article-admin">
              <p>USD $<%= propiedad.price.toLocaleString('en-US') %> - <%= getPropertyType(propiedad.type) %></p>
              <h2><%= propiedad.adress.toUpperCase() %></h2>
              <p><%= propiedad.city %></p>
              <p><%= propiedad.personalName %></p>
            </div>
          </div>
        </article>
      </a>
    <% }) %>
    
    <!-- Bloque: Solo Alquiler -->
    <% propiedades.filter(p => p.type == 2).forEach(propiedad => { %>
      <a class="alquiler-propiedades" style="opacity: 0; pointer-events: none;" href="/articulo/<%= propiedad.id %>">
        <article class="article-box-admin">
          <div style="display: flex">
            <div><img class="img-imagendepropiedades-admin" src="<%= propiedad.principalImage %>"></div>
            <div class="left-article-admin">
              <p>USD $<%= propiedad.price.toLocaleString('en-US') %> - <%= getPropertyType(propiedad.type) %></p>
              <h2><%= propiedad.adress.toUpperCase() %></h2>
              <p><%= propiedad.city %></p>
              <p><%= propiedad.personalName %></p>
            </div>
          </div>
        </article>
      </a>
    <% }) %>
    
    <!-- Bloque: Solo Venta -->
    <% propiedades.filter(p => p.type == 1).forEach(propiedad => { %>
      <a class="venta-propiedades" style="opacity: 0; pointer-events: none;" href="/articulo/<%= propiedad.id %>">
        <article class="article-box-admin">
          <div style="display: flex">
            <div><img class="img-imagendepropiedades-admin" src="<%= propiedad.principalImage %>"></div>
            <div class="left-article-admin">
              <p>USD $<%= propiedad.price.toLocaleString('en-US') %> - <%= getPropertyType(propiedad.type) %></p>
              <h2><%= propiedad.adress.toUpperCase() %></h2>
              <p><%= propiedad.city %></p>
              <p><%= propiedad.personalName %></p>
            </div>
          </div>
        </article>
      </a>
    <% }) %>
    
      <% if (propiedades.length === 0) { %>
        <p style="margin-top: 20px;">No se encontraron propiedades.</p>
      <% } %>
  </main>
  <script>
  document.addEventListener("DOMContentLoaded", function () {
  const btnAlquileres = document.getElementById("filtrar-alquileres");
  const btnVentas = document.getElementById("filtrar-ventas");
  const btnMostrarTodo = document.getElementById("mostrar-todo");

  const todasPropiedades = document.querySelectorAll(".todas-propiedades");
  const alquilerPropiedades = document.querySelectorAll(".alquiler-propiedades");
  const ventaPropiedades = document.querySelectorAll(".venta-propiedades");

  function ocultarInstantaneamente(elementos) {
    elementos.forEach(el => {
      el.style.transition = "none";  // Quitamos la transición
      el.style.opacity = "0";
      el.style.pointerEvents = "none";
      el.style.position = "absolute";
    });
  }

  function mostrarConTransicion(elementos) {
    elementos.forEach(el => {
      el.style.transition = "opacity 0.5s ease"; // Aplicamos transición solo al mostrar
      el.style.opacity = "1";
      el.style.pointerEvents = "all";
      el.style.position = "relative";
    });
  }

  function mostrar(tipo) {
    if (tipo === "todas") {
      ocultarInstantaneamente([...alquilerPropiedades, ...ventaPropiedades]);
      setTimeout(() => mostrarConTransicion(todasPropiedades), 50);
    } else if (tipo === "alquiler") {
      ocultarInstantaneamente([...todasPropiedades, ...ventaPropiedades]);
      setTimeout(() => mostrarConTransicion(alquilerPropiedades), 50);
    } else if (tipo === "venta") {
      ocultarInstantaneamente([...todasPropiedades, ...alquilerPropiedades]);
      setTimeout(() => mostrarConTransicion(ventaPropiedades), 50);
    }
  }

  // Al cargar la página, aseguramos que "mostrar todas" esté visible
  mostrar("todas");

  btnAlquileres.addEventListener("click", () => mostrar("alquiler"));
  btnVentas.addEventListener("click", () => mostrar("venta"));
  btnMostrarTodo.addEventListener("click", () => mostrar("todas"));
});

  </script>
  
  
</body>
</html>